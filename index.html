<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Crypto GEM RASA</title>
    <link rel="icon" type="image/png" href="https://via.placeholder.com/32"> <!-- Placeholder favicon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
    html, body {
        direction: ltr !important;
    }
    body {
        font-family: 'Segoe UI', sans-serif;
        margin: 0;
        padding: 0;
        padding-bottom: 70px;
        background: url('https://i.imgur.com/nq2jGI2.jpeg') no-repeat center center fixed, linear-gradient(135deg, #1e3c72, #2a5298);
        background-size: cover;
        color: #fff;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        align-items: center;
        position: relative;
        box-sizing: border-box;
        overflow: hidden;
    }
    .container {
        background: linear-gradient(135deg, rgba(30, 60, 114, 0.8), rgba(42, 82, 152, 0.8));
        backdrop-filter: blur(15px);
        border-radius: 20px;
        padding: 20px;
        box-shadow: 0 0 20px rgba(0, 234, 255, 0.5);
        border: 1px solid #00eaff;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        align-items: center;
        width: 340px;
        margin: 20px auto;
        flex-grow: 1;
        animation: fadeIn 1s ease-in-out forwards;
        position: relative;
        box-sizing: border-box;
        overflow: hidden;
        max-height: calc(100vh - 110px);
    }
    .container > * {
        width: 100%;
        box-sizing: border-box;
    }
    .container:hover {
        transform: scale(1.02);
        box-shadow: 0 0 30px rgba(0, 234, 255, 0.8);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    @keyframes fadeIn {
        0% { opacity: 0; transform: translateY(20px); }
        100% { opacity: 1; transform: translateY(0); }
    }
    .container h1 {
        margin: 10px 0;
        text-align: center;
        font-size: 1rem;
    }
    .container p {
        margin: 10px 0;
        text-align: center;
        font-size: 0.8rem;
    }
    #main-content h1 {
        font-size: 1.5rem;
        background: linear-gradient(90deg, #00eaff, #ff00ff);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-shadow: 0 0 10px rgba(0, 234, 255, 0.8);
        margin: 10px 0;
        text-align: center;
    }
    #main-content p {
        font-size: 1rem;
        color: #fff;
        text-shadow: 0 0 5px rgba(0, 234, 255, 0.6);
        margin: 10px 0;
        text-align: center;
    }
    @media (max-width: 768px) {
        .container { padding: 15px; margin: 10px auto; }
        .container h1 { font-size: 0.9rem; }
        .container p { font-size: 0.7rem; }
        #main-content h1 { font-size: 1.2rem; }
        #main-content p { font-size: 0.9rem; }
    }
    .icon-wrapper {
        margin: 20px 0;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    .icon {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        border: 3px solid #00eaff;
        box-shadow: 0 0 20px rgba(0, 234, 255, 0.5);
        transition: transform 0.3s ease;
    }
    .icon:hover {
        transform: scale(1.1);
        box-shadow: 0 0 30px rgba(0, 234, 255, 0.8);
    }
    .mining-wrapper {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 50vh;
        max-height: 300px;
        overflow-y: auto;
    }
    .mining-circle {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        border: 3px solid #00eaff;
        box-shadow: 0 0 20px rgba(0, 234, 255, 0.5);
        cursor: pointer;
        transition: transform 0.3s ease;
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 20px 0;
        outline: none;
        -webkit-tap-highlight-color: transparent;
        position: relative;
    }
    .mining-circle img {
        width: 100%;
        height: 100%;
        border-radius: 50%;
    }
    .mining-circle.disabled {
        opacity: 0.5;
        cursor: not-allowed;
        border-color: #666;
        box-shadow: none;
    }
    .mining-circle:active {
        animation: pulse 0.3s ease;
    }
    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.1); }
        100% { transform: scale(1); }
    }
    .mining-info {
        text-align: center;
        margin-top: 10px;
    }
    .mining-info span {
        font-size: 0.8rem;
    }
    .earnings-form {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 20px;
        max-height: 200px;
        overflow-y: auto;
    }
    .earnings-form input {
        padding: 10px;
        margin: 10px 0;
        border-radius: 5px;
        border: none;
        width: 80%;
        max-width: 300px;
        font-size: 0.8rem;
    }
    .earnings-form button {
        padding: 10px 20px;
        background: #00eaff;
        color: #1e1e2f;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.3s ease;
        font-size: 0.8rem;
    }
    .earnings-form button:hover {
        background: #66eaff;
    }
    .friends-wrapper {
        text-align: center;
        margin-top: 20px;
        max-height: 300px;
        overflow-y: auto;
    }
    .friends-wrapper button {
        padding: 10px 20px;
        background: #00eaff;
        color: #1e1e2f;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.3s ease;
        margin-top: 10px;
        font-size: 0.8rem;
    }
    .friends-wrapper button:hover {
        background: #66eaff;
    }
    .friends-list {
        margin: 20px;
    }
    .friends-list p {
        margin: 5px 0;
        font-size: 0.8rem;
    }
    .back-button:hover {
        color: #66eaff;
    }
    .footer-nav {
        position: fixed;
        bottom: 10px;
        left: 0;
        width: 100%;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        padding: 10px 0;
        display: flex;
        justify-content: space-around;
        align-items: center;
        border-top: 1px solid rgba(255, 255, 255, 0.2);
        border-bottom: 1px solid #00eaff;
        z-index: 1000;
        box-sizing: border-box;
    }
    .footer-nav a {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-decoration: none;
        color: #00eaff;
        font-size: 0.45rem;
        transition: color 0.3s;
    }
    .footer-nav a:hover { color: #66eaff; }
    .footer-nav i {
        font-size: 24px;
        margin-bottom: 5px;
        color: #00eaff;
        transition: color 0.3s;
    }
    .footer-nav a:hover i { color: #66eaff; }
    .page-content { display: none; }
    .page-content.active { display: block; }
    .language-menu {
        position: absolute;
        top: 10px;
        left: 10px;
    }
    .language-button {
        background: linear-gradient(135deg, #00eaff, #1e3c72);
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        box-shadow: 0 0 10px rgba(0, 234, 255, 0.5);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .language-button:hover {
        transform: scale(1.1);
        box-shadow: 0 0 20px rgba(0, 234, 255, 0.8);
    }
    .language-button i {
        color: #fff;
        font-size: 20px;
    }
    .language-dropdown {
        display: none;
        position: absolute;
        top: 50px;
        left: 0;
        background: linear-gradient(135deg, #1e3c72, #2a5298);
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 234, 255, 0.5);
        z-index: 1000;
    }
    .language-dropdown a {
        display: block;
        padding: 10px 20px;
        color: #fff;
        text-decoration: none;
        font-size: 0.8rem;
        transition: background 0.3s ease;
    }
    .language-dropdown a:hover {
        background: rgba(0, 234, 255, 0.2);
    }
    .language-menu:hover .language-dropdown {
        display: block;
    }
    .social-links {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
        margin-top: 20px;
        padding-left: 10px;
        max-height: 300px;
        overflow-y: auto;
    }
    .social-link {
        display: flex;
        align-items: center;
        text-decoration: none;
        color: #fff;
        font-size: 1rem;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        outline: none;
        -webkit-tap-highlight-color: transparent;
    }
    .social-link i {
        font-size: 24px;
        margin-right: 10px;
        background: linear-gradient(135deg, #ffd700, #c0c0c0);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        transition: transform 0.3s ease;
    }
    .social-link span {
        text-shadow: 0 0 5px rgba(255, 215, 0, 0.6);
        text-align: left;
    }
    .social-link:hover {
        transform: scale(1.05);
        box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
    }
    .social-link:hover i {
        transform: scale(1.2);
    }
    .touch-effect {
        position: absolute;
        width: 10px;
        height: 10px;
        background: linear-gradient(135deg, #00eaff, #ffffff);
        border-radius: 50%;
        pointer-events: none;
        animation: fadeOut 0.5s ease forwards;
    }
    @keyframes fadeOut {
        0% { opacity: 1; transform: scale(1); }
        100% { opacity: 0; transform: scale(2); }
    }
    .referral-link-container {
        display: block;
        width: 80%;
        max-width: 300px;
        margin: 10px auto;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        font-size: 0.8rem;
        color: #00eaff;
        padding: 5px;
        border: 1px solid #00eaff;
        border-radius: 5px;
        background: rgba(0, 234, 255, 0.1);
        text-align: center;
    }
    #splash-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: black;
        z-index: 9999;
    }
    #intro-video {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    .news-section {
        margin-top: 20px;
        width: 100%;
        text-align: center;
        max-height: 300px;
        overflow-y: auto;
    }
    .news-section h2 {
        font-size: 1.2rem;
        background: linear-gradient(90deg, #00eaff, #ff00ff);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-shadow: 0 0 10px rgba(0, 234, 255, 0.8);
        margin: 10px 0;
    }
    .news-item {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid #00eaff;
        border-radius: 10px;
        padding: 10px;
        margin: 10px 0;
        box-shadow: 0 0 10px rgba(0, 234, 255, 0.3);
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .news-item img {
        width: 50px;
        height: 50px;
        object-fit: cover;
        border-radius: 5px;
    }
    .news-item p {
        font-size: 0.8rem;
        margin: 0;
        color: #fff;
        text-shadow: 0 0 5px rgba(0, 234, 255, 0.6);
        flex: 1;
    }
    @media (max-width: 768px) {
        .news-section h2 { font-size: 1rem; }
        .news-item p { font-size: 0.7rem; }
        .news-item img { width: 40px; height: 40px; }
    }
    .post-item {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid #00eaff;
        border-radius: 10px;
        padding: 10px;
        margin: 10px 0;
        box-shadow: 0 0 10px rgba(0, 234, 255, 0.3);
    }
    .post-item p {
        font-size: 0.8rem;
        margin: 5px 0;
        color: #fff;
        text-shadow: 0 0 5px rgba(0, 234, 255, 0.6);
    }
    .comment-input {
        padding: 10px;
        margin: 10px 0;
        border-radius: 5px;
        border: none;
        width: 80%;
        max-width: 300px;
        font-size: 0.8rem;
    }
    .comment-button {
        padding: 10px 20px;
        background: #00eaff;
        color: #1e1e2f;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.3s ease;
        font-size: 0.8rem;
    }
    .comment-button:hover {
        background: #66eaff;
    }
    @media (max-width: 768px) {
        .post-item p { font-size: 0.7rem; }
        .comment-input { font-size: 0.7rem; }
        .comment-button { font-size: 0.7rem; }
    }
    </style>
</head>
<body>
    <!-- <div id="splash-screen">
        <video id="intro-video" autoplay muted>
            <source src="splash-video.mp4" type="video/mp4">
            Your browser doesn’t support video.
        </video>
    </div> -->

    <!-- <audio id="backgroundMusic" loop>
        <source src="background-music.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio> -->

    <div class="container" id="main-content" style="display: none;">
        <div class="language-menu">
            <button class="language-button">
                <i class="fas fa-globe"></i>
            </button>
            <div class="language-dropdown">
                <a href="#" onclick="changeLanguage('en'); return false;">English</a>
                <a href="#" onclick="changeLanguage('ru'); return false;">Русский</a>
            </div>
        </div>
        <div class="icon-wrapper">
            <img src="https://via.placeholder.com/120" alt="Crypto GEM RASA Icon" class="icon">
        </div>
        <h1 data-lang="title">Crypto GEM RASA</h1>
        <p data-lang="welcome">Welcome to Crypto GEM RASA! Stay tuned for exciting updates.</p>
        <div class="news-section">
            <h2 data-lang="news-title">Crypto News</h2>
            <div id="news-container"></div>
        </div>
    </div>

    <div class="container page-content" id="social-page">
        <div class="back-button" onclick="goToHome()" style="position: absolute; top: 10px; left: 20px; right: auto; color: #00eaff; font-size: 24px; cursor: pointer;">
            <i class="fas fa-home"></i>
        </div>
        <h1 data-lang="social-title">Social Networks</h1>
        <p data-lang="social-text">Follow us on our social media platforms!</p>
        <div class="social-links">
            <a href="https://t.me/Crypto_GEM_RASA" target="_blank" class="social-link">
                <i class="fab fa-telegram-plane"></i>
                <span>Telegram</span>
            </a>
            <a href="https://www.instagram.com/crypto_gem_rasa?igsh=dDBneTRpNWt6OHNk" target="_blank" class="social-link">
                <i class="fab fa-instagram"></i>
                <span>Instagram</span>
            </a>
            <a href="https://www.reddit.com/u/RASA_TEAM/s/VjWS27u1P4" target="_blank" class="social-link">
                <i class="fab fa-reddit-alien"></i>
                <span>Reddit</span>
            </a>
            <a href="https://www.threads.net/@crypto_gem_rasa" target="_blank" class="social-link">
                <i class="fas fa-comment-dots"></i>
                <span>Threads</span>
            </a>
            <a href="https://x.com/Crypto_GEM_RASA?t=oiR1MbXSMKHk9NzIOmmecw&s=09" target="_blank" class="social-link">
                <i class="fab fa-twitter"></i>
                <span>Twitter</span>
            </a>
            <a href="https://youtube.com/@crypto_gem_rasa?si=xZ5lpwZ7kT1q83Bc" target="_blank" class="social-link">
                <i class="fab fa-youtube"></i>
                <span>YouTube</span>
            </a>
            <a href="https://www.tiktok.com/@crypto_gem_rasa?_t=ZS-8vDQtVW04wM&_r=1" target="_blank" class="social-link">
                <i class="fab fa-tiktok"></i>
                <span>TikTok</span>
            </a>
            <a href="https://medium.com/@Crypto_Gem_RASA" target="_blank" class="social-link">
                <i class="fab fa-medium-m"></i>
                <span>Medium</span>
            </a>
        </div>
    </div>

    <div class="container page-content" id="tasks-page">
        <div class="back-button" onclick="goToHome()" style="position: absolute; top: 10px; left: 20px; right: auto; color: #00eaff; font-size: 24px; cursor: pointer;">
            <i class="fas fa-home"></i>
        </div>
        <h1 data-lang="tasks-title">Tasks</h1>
        <p data-lang="tasks-text">List of tasks for users.</p>
    </div>

    <div class="container page-content" id="mining-page">
        <div class="back-button" onclick="goToHome()" style="position: absolute; top: 10px; left: 20px; right: auto; color: #00eaff; font-size: 24px; cursor: pointer;">
            <i class="fas fa-home"></i>
        </div>
        <h1 data-lang="mining-title">Mining</h1>
        <p data-lang="mining-text">Tap the circle to mine! You can mine 500 units every 8 hours.</p>
        <div class="mining-wrapper">
            <div class="mining-circle" id="miningCircle">
                <img src="https://via.placeholder.com/120" alt="Mining Circle">
            </div>
            <div class="mining-info">
                <span id="miningCount">0 / 500</span><br>
                <span id="totalMiningCount">Total Mined: 0</span><br>
                <span id="timeRemaining"></span>
            </div>
        </div>
    </div>

    <div class="container page-content" id="partnerships-page">
        <div class="back-button" onclick="goToHome()" style="position: absolute; top: 10px; left: 20px; right: auto; color: #00eaff; font-size: 24px; cursor: pointer;">
            <i class="fas fa-home"></i>
        </div>
        <h1 data-lang="partnerships-title">Partnerships</h1>
        <p data-lang="partnerships-text">Details of partnerships.</p>
    </div>

    <div class="container page-content" id="comments-page">
        <div class="back-button" onclick="goToHome()" style="position: absolute; top: 10px; left: 20px; right: auto; color: #00eaff; font-size: 24px; cursor: pointer;">
            <i class="fas fa-home"></i>
        </div>
        <h1 data-lang="comments-title">Comments</h1>
        <p data-lang="comments-text">User comments will be displayed here.</p>
    </div>

    <div class="container page-content" id="earnings-page">
        <div class="back-button" onclick="goToHome()" style="position: absolute; top: 10px; left: 20px; right: auto; color: #00eaff; font-size: 24px; cursor: pointer;">
            <i class="fas fa-home"></i>
        </div>
        <h1 data-lang="earnings-title">Earnings</h1>
        <p data-lang="earnings-text">Answer the question to earn 200 tokens!</p>
        <p>Total Tokens: <span id="userTokens">0</span></p>
        <p id="currentQuestion"></p>
        <div class="earnings-form">
            <input type="text" id="answerInput" placeholder="Your answer">
            <button onclick="checkAnswer()">Submit Answer</button>
        </div>
        <p id="answerFeedback"></p>
    </div>

    <div class="container page-content" id="friends-page">
        <div class="back-button" onclick="goToHome()" style="position: absolute; top: 10px; left: 20px; right: auto; color: #00eaff; font-size: 24px; cursor: pointer;">
            <i class="fas fa-home"></i>
        </div>
        <h1 data-lang="friends-title">Friends</h1>
        <p data-lang="friends-text">Invite friends to earn 1000 tokens per referral (max 5).</p>
        <div class="friends-wrapper">
            <p>Your Referral Link:</p>
            <span id="referralLink" class="referral-link-container"></span>
            <button onclick="copyReferralLink()">Copy Link</button>
            <div class="friends-list">
                <h3>Invited Friends (<span id="friendsCount">0</span>/5)</h3>
                <div id="friendsList"></div>
            </div>
        </div>
    </div>

    <div class="container page-content" id="channel-posts-page">
        <div class="back-button" onclick="goToHome()" style="position: absolute; top: 10px; left: 20px; right: auto; color: #00eaff; font-size: 24px; cursor: pointer;">
            <i class="fas fa-home"></i>
        </div>
        <h1 data-lang="posts-title">Channel Posts</h1>
        <p data-lang="posts-text">View the latest posts from our Telegram channel.</p>
        <div class="news-section">
            <div id="posts"></div>
        </div>
    </div>

    <div class="footer-nav">
        <a href="#" onclick="showPage('social-page'); return false;">
            <i class="fas fa-users"></i>
            <span data-lang="social-nav">Social</span>
        </a>
        <a href="#" onclick="showPage('tasks-page'); return false;">
            <i class="fas fa-tasks"></i>
            <span data-lang="tasks-nav">Tasks</span>
        </a>
        <a href="#" onclick="showPage('mining-page'); return false;">
            <i class="fas fa-gem"></i>
            <span data-lang="mining-nav">Mining</span>
        </a>
        <a href="#" onclick="showPage('partnerships-page'); return false;">
            <i class="fas fa-handshake"></i>
            <span data-lang="partnerships-nav">Partners</span>
        </a>
        <a href="#" onclick="showPage('comments-page'); return false;">
            <i class="fas fa-comments"></i>
            <span data-lang="comments-nav">Comments</span>
        </a>
        <a href="#" onclick="showPage('earnings-page'); return false;">
            <i class="fas fa-money-bill"></i>
            <span data-lang="earnings-nav">Earnings</span>
        </a>
        <a href="#" onclick="showPage('friends-page'); return false;">
            <i class="fas fa-user-friends"></i>
            <span data-lang="friends-nav">Friends</span>
        </a>
        <a href="#" onclick="showChannelPosts(); return false;">
            <i class="fas fa-newspaper"></i>
            <span data-lang="posts-nav">Posts</span>
        </a>
    </div>

    <!-- <audio id="clickSound" src="click-sound.mp3"></audio> -->
<script>
    const translations = {
        en: {
            title: "Crypto GEM RASA",
            welcome: "Welcome to Crypto GEM RASA! Stay tuned for exciting updates.",
            "social-title": "Social Networks",
            "social-text": "Follow us on our social media platforms!",
            "tasks-title": "Tasks",
            "tasks-text": "List of tasks for users.",
            "mining-title": "Mining",
            "mining-text": "Tap the circle to mine! You can mine 500 units every 8 hours.",
            "partnerships-title": "Partnerships",
            "partnerships-text": "Details of partnerships.",
            "comments-title": "Comments",
            "comments-text": "User comments will be displayed here.",
            "earnings-title": "Earnings",
            "earnings-text": "Answer the question to earn 200 tokens!",
            "friends-title": "Friends",
            "friends-text": "Invite friends to earn 1000 tokens per referral (max 5).",
            "social-nav": "Social",
            "tasks-nav": "Tasks",
            "mining-nav": "Mining",
            "partnerships-nav": "Partners",
            "comments-nav": "Comments",
            "earnings-nav": "Earnings",
            "friends-nav": "Friends",
            "news-title": "Crypto News",
            "posts-title": "Channel Posts",
            "posts-text": "View the latest posts from our Telegram channel.",
            "posts-nav": "Posts"
        },
        ru: {
            title: "Crypto GEM RASA",
            welcome: "Добро пожаловать в Crypto GEM RASA! Следите за обновлениями.",
            "social-title": "Социальные сети",
            "social-text": "Подписывайтесь на нас в социальных сетях!",
            "tasks-title": "Задания",
            "tasks-text": "Список заданий для пользователей.",
            "mining-title": "Майнинг",
            "mining-text": "Нажмите на круг, чтобы добывать! Вы можете добыть 500 единиц каждые 8 часов.",
            "partnerships-title": "Партнерства",
            "partnerships-text": "Подробности о партнерствах.",
            "comments-title": "Комментарии",
            "comments-text": "Комментарии пользователей будут отображаться здесь.",
            "earnings-title": "Заработок",
            "earnings-text": "Ответьте на вопрос, чтобы заработать 200 токенов!",
            "friends-title": "Друзья",
            "friends-text": "Приглашайте друзей, чтобы заработать 1000 токенов за каждого (макс. 5).",
            "social-nav": "Социальные",
            "tasks-nav": "Задания",
            "mining-nav": "Майнинг",
            "partnerships-nav": "Партнеры",
            "comments-nav": "Комментарии",
            "earnings-nav": "Заработок",
            "friends-nav": "Друзья",
            "news-title": "Новости Криптовалют",
            "posts-title": "Посты канала",
            "posts-text": "Просматривайте последние посты из нашего Telegram-канала.",
            "posts-nav": "Посты"
        }
    };

    let currentLang = "en";
    let miningCount = parseInt(localStorage.getItem('miningCount')) || 0;
    let totalMiningCount = parseInt(localStorage.getItem('totalMiningCount')) || 0;
    let lastMiningTime = parseInt(localStorage.getItem('lastMiningTime')) || 0;
    let userTokens = parseInt(localStorage.getItem('userTokens')) || 0;
    let friendsCount = parseInt(localStorage.getItem('friendsCount')) || 0;
    let friendsList = JSON.parse(localStorage.getItem('friendsList')) || [];

    let referralCode = localStorage.getItem('referralCode');
    if (!referralCode) {
        referralCode = Math.random().toString(36).substring(2, 8);
        localStorage.setItem('referralCode', referralCode);
    }

    const miningLimit = 500;
    const miningInterval = 8 * 60 * 60 * 1000;

    const defaultNews = [
        { title: "Bitcoin hits $70,000 amid market rally", imageurl: "https://via.placeholder.com/50", published_on: Date.now() / 1000 - 3600 },
        { title: "Ethereum ETF approval boosts prices", imageurl: "https://via.placeholder.com/50", published_on: Date.now() / 1000 - 7200 },
        { title: "Solana announces new DeFi integration", imageurl: "https://via.placeholder.com/50", published_on: Date.now() / 1000 - 18000 }
    ];

    async function fetchCryptoNews() {
        try {
            const url = `https://min-api.cryptocompare.com/data/v2/news/?lang=EN`;
            console.log("Fetching news from:", url);
            const response = await fetch(url);
            const data = await response.json();
            console.log("API Response:", data);

            if (data.Data && data.Data.length > 0) {
                const newsContainer = document.getElementById('news-container');
                newsContainer.innerHTML = '';

                data.Data.slice(0, 3).forEach(article => {
                    const newsItem = document.createElement('div');
                    newsItem.classList.add('news-item');

                    const newsImage = document.createElement('img');
                    newsImage.src = article.imageurl || 'https://via.placeholder.com/50';
                    newsImage.alt = article.title;
                    newsImage.onerror = () => { newsImage.src = 'https://via.placeholder.com/50'; };

                    const newsText = document.createElement('p');
                    const publishedAt = new Date(article.published_on * 1000);
                    const timeAgo = Math.floor((Date.now() - publishedAt) / (1000 * 60 * 60));
                    newsText.textContent = `${article.title} - ${timeAgo} hours ago`;

                    newsItem.appendChild(newsImage);
                    newsItem.appendChild(newsText);
                    newsContainer.appendChild(newsItem);
                });
            } else {
                console.error('No news available:', data.message || 'Unknown error');
                displayDefaultNews();
            }
        } catch (error) {
            console.error('Error fetching news:', error);
            const newsContainer = document.getElementById('news-container');
            newsContainer.innerHTML = '';
            const errorMessage = document.createElement('p');
            errorMessage.textContent = currentLang === 'en' 
                ? "Oops! Looks like something broke. Take a deep breath and try again—we’ll fix it!" 
                : "Ой! Кажется, что-то сломалось. Сделай глубокий вдох и попробуй снова — мы это исправим!";
            newsContainer.appendChild(errorMessage);
        }
    }

    function displayDefaultNews() {
        const newsContainer = document.getElementById('news-container');
        newsContainer.innerHTML = '';

        try {
            defaultNews.forEach(article => {
                const newsItem = document.createElement('div');
                newsItem.classList.add('news-item');

                const newsImage = document.createElement('img');
                newsImage.src = article.imageurl;
                newsImage.alt = article.title;

                const newsText = document.createElement('p');
                const publishedAt = new Date(article.published_on * 1000);
                const timeAgo = Math.floor((Date.now() - publishedAt) / (1000 * 60 * 60));
                newsText.textContent = `${article.title} - ${timeAgo} hours ago`;

                newsItem.appendChild(newsImage);
                newsItem.appendChild(newsText);
                newsContainer.appendChild(newsItem);
            });
        } catch (error) {
            console.error('Error displaying default news:', error);
            const errorMessage = document.createElement('p');
            errorMessage.textContent = currentLang === 'en' 
                ? "Oops! Looks like something broke. Take a deep breath and try again—we’ll fix it!" 
                : "Ой! Кажется, что-то сломалось. Сделай глубокий вдох и попробуй снова — мы это исправим!";
            newsContainer.appendChild(errorMessage);
        }
    }

    function showPage(pageId) {
        document.querySelectorAll('.page-content').forEach(page => page.classList.remove('active'));
        document.getElementById('main-content').style.display = 'none';
        document.getElementById(pageId).classList.add('active');
        if (pageId === 'earnings-page') loadQuestion();
        if (pageId === 'friends-page') updateFriendsPage();
    }

    function goToHome() {
        document.querySelectorAll('.page-content').forEach(page => page.classList.remove('active'));
        document.getElementById('main-content').style.display = 'block';
        fetchCryptoNews();
    }

    function showChannelPosts() {
        showPage('channel-posts-page');
        fetch('http://localhost:3000/posts')
            .then(res => res.json())
            .then(posts => {
                const postsDiv = document.getElementById('posts');
                postsDiv.innerHTML = '';
                posts.forEach(post => {
                    const postDiv = document.createElement('div');
                    postDiv.className = 'post-item';
                    postDiv.innerHTML = `
                        <p>${post.text}</p>
                        <p><small>${new Date(post.date * 1000).toLocaleString()}</small></p>
                        <div>
                            ${post.comments.map(c => `<p>${c}</p>`).join('')}
                        </div>
                        <input class="comment-input" id="comment-${post.id}" placeholder="${currentLang === 'en' ? 'Your comment' : 'Ваш комментарий'}">
                        <button class="comment-button" onclick="addComment(${post.id})">${currentLang === 'en' ? 'Submit Comment' : 'Отправить комментарий'}</button>
                    `;
                    postsDiv.appendChild(postDiv);
                });
            })
            .catch(err => {
                console.error('Error fetching posts:', err);
                const postsDiv = document.getElementById('posts');
                postsDiv.innerHTML = `<p>${currentLang === 'en' ? 'Error loading posts. Please try again.' : 'Ошибка загрузки постов. Попробуйте снова.'}</p>`;
            });
    }

    function addComment(postId) {
        const commentInput = document.getElementById(`comment-${postId}`);
        const comment = commentInput.value.trim();
        if (comment) {
            fetch('http://localhost:3000/comment', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ postId, comment })
            })
                .then(res => res.json())
                .then(data => {
                    if (data.success) {
                        commentInput.value = '';
                        showChannelPosts();
                    } else {
                        alert(currentLang === 'en' ? 'Error: Post not found.' : 'Ошибка: Пост не найден.');
                    }
                })
                .catch(err => {
                    console.error('Error adding comment:', err);
                    alert(currentLang === 'en' ? 'Error adding comment. Please try again.' : 'Ошибка добавления комментария. Попробуйте снова.');
                });
        } else {
            alert(currentLang === 'en' ? 'Please enter a comment.' : 'Пожалуйста, введите комментарий.');
        }
    }

    function showTouchEffect(event) {
        const circle = document.getElementById('miningCircle');
        const rect = circle.getBoundingClientRect();
        let x, y;
        if (event.type === 'touchstart') {
            x = event.touches[0].clientX - rect.left;
            y = event.touches[0].clientY - rect.top;
        } else {
            x = event.clientX - rect.left;
            y = event.clientY - rect.top;
        }
        const touchDot = document.createElement('div');
        touchDot.classList.add('touch-effect');
        touchDot.style.left = `${x - 5}px`;
        touchDot.style.top = `${y - 5}px`;
        circle.appendChild(touchDot);
        setTimeout(() => touchDot.remove(), 500);
    }

    function updateMiningStatus() {
        const now = Date.now();
        const timeElapsed = now - lastMiningTime;
        const timeRemaining = miningInterval - timeElapsed;

        document.getElementById('miningCount').textContent = `${miningCount} / ${miningLimit}`;
        document.getElementById('totalMiningCount').textContent = `Total Mined: ${totalMiningCount}`;

        if (timeRemaining > 0) {
            const hours = Math.floor(timeRemaining / (1000 * 60 * 60));
            const minutes = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeRemaining % (1000 * 60)) / 1000);
            document.getElementById('timeRemaining').textContent = `Next mining in: ${hours}h ${minutes}m ${seconds}s`;
            document.getElementById('miningCircle').classList.add('disabled');
        } else {
            document.getElementById('timeRemaining').textContent = '';
            document.getElementById('miningCircle').classList.remove('disabled');
        }
    }

    function mine() {
        const now = Date.now();
        const timeElapsed = now - lastMiningTime;

        if (timeElapsed >= miningInterval || lastMiningTime === 0) {
            if (miningCount < miningLimit) {
                miningCount += 5;
                totalMiningCount += 5;
                if (miningCount >= miningLimit) {
                    miningCount = miningLimit;
                    lastMiningTime = now;
                }
                localStorage.setItem('miningCount', miningCount);
                localStorage.setItem('totalMiningCount', totalMiningCount);
                localStorage.setItem('lastMiningTime', lastMiningTime);
            }
        }
        updateMiningStatus();
    }

    function playClickSound() {
        // Temporarily disabled due to missing audio file
        console.log("Click sound would play here if audio file were available");
    }

    function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }

    const debouncedMine = debounce(mine, 100);

    const miningCircle = document.getElementById('miningCircle');
    miningCircle.addEventListener('click', (e) => {
        if (!miningCircle.classList.contains('disabled')) {
            showTouchEffect(e);
            playClickSound();
            debouncedMine();
        }
    });
    miningCircle.addEventListener('touchstart', (e) => {
        e.preventDefault();
        if (!miningCircle.classList.contains('disabled')) {
            showTouchEffect(e);
            playClickSound();
            debouncedMine();
        }
    });

    function changeLanguage(lang) {
        currentLang = lang;
        document.querySelectorAll('[data-lang]').forEach(element => {
            const key = element.getAttribute('data-lang');
            element.textContent = translations[lang][key];
        });
    }

    const questions = [
        { question: "What is 2 + 2?", answer: "4" },
        { question: "What is the capital of France?", answer: "Paris" },
        { question: "What is 5 x 3?", answer: "15" }
    ];
    let currentQuestionIndex = parseInt(localStorage.getItem('currentQuestionIndex')) || 0;

    function loadQuestion() {
        if (currentQuestionIndex >= questions.length) {
            document.getElementById('currentQuestion').textContent = "No more questions available.";
            document.getElementById('answerInput').style.display = 'none';
            document.getElementById('answerFeedback').textContent = '';
            document.querySelector('.earnings-form button').style.display = 'none';
            return;
        }
        document.getElementById('currentQuestion').textContent = questions[currentQuestionIndex].question;
        document.getElementById('answerInput').value = '';
        document.getElementById('answerFeedback').textContent = '';
    }

    function checkAnswer() {
        const userAnswer = document.getElementById('answerInput').value.trim().toLowerCase();
        const correctAnswer = questions[currentQuestionIndex].answer.toLowerCase();
        if (userAnswer === correctAnswer) {
            userTokens += 200;
            localStorage.setItem('userTokens', userTokens);
            document.getElementById('userTokens').textContent = userTokens;
            document.getElementById('answerFeedback').textContent = "Correct! You earned 200 tokens.";
            currentQuestionIndex++;
            localStorage.setItem('currentQuestionIndex', currentQuestionIndex);
            setTimeout(loadQuestion, 1000);
        } else {
            document.getElementById('answerFeedback').textContent = "Wrong answer. Try again!";
        }
    }

    function updateFriendsPage() {
        const baseUrl = "https://t.me/CryptoGemRasa_Bot/app";
        const referralLink = `${baseUrl}?start=${referralCode}`;
        document.getElementById('referralLink').dataset.fullLink = referralLink;
        document.getElementById('referralLink').textContent = referralLink;
        document.getElementById('friendsCount').textContent = friendsCount;
        const friendsListDiv = document.getElementById('friendsList');
        friendsListDiv.innerHTML = '';
        friendsList.forEach(friend => {
            const p = document.createElement('p');
            p.textContent = friend;
            friendsListDiv.appendChild(p);
        });
    }

    function copyReferralLink() {
        const referralLink = document.getElementById('referralLink').dataset.fullLink;
        navigator.clipboard.writeText(referralLink).then(() => {
            alert('Referral link copied to clipboard!');
        }).catch(err => {
            console.error('Failed to copy referral link:', err);
            alert('Failed to copy the link. Please copy it manually.');
        });
    }

    window.onload = function() {
        document.getElementById('main-content').style.display = 'block';
        changeLanguage(currentLang);
        updateMiningStatus();
        document.getElementById('userTokens').textContent = userTokens;
        setInterval(updateMiningStatus, 1000);
        fetchCryptoNews();

        // Temporarily disable splash screen and background music
        const mainContent = document.getElementById("main-content");
        mainContent.style.display = "block";
    };
</script>
</body>
</html>
